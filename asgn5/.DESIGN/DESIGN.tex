\documentclass[12pt]{article}
\usepackage{charter} % font
\usepackage[margin=1in]{geometry} % margin
\usepackage{varioref} % "on the next page" label decoration
\usepackage{hyperref} % hyperlinks
\usepackage{enumitem} % Enumeration
\usepackage{float} % table placement

\usepackage[lined,dotocloa]{algorithm2e} % Pseudocode
\labelformat{algocf}{\textit{alg.}\,(#1)}

% Questions
\newenvironment{QandA}{\begin{enumerate}[label=\bfseries\alph*.]\bfseries}
{\end{enumerate}}
\newenvironment{answered}{\par\normalfont}{}
\usepackage{lipsum}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{%
    \textbf{Assignment 5 \\ 
        Hamming Codes \\
\large DESIGN DOCUMENT} }
\author{Zack Traczyk \\ CSE13S - Spring 2021}
\date{Due: May 9\textsuperscript{th} at 11:59 pm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\maketitle

\section{Objective}

The main programs, encode and decode, encode and decode files using the
Hamming(8,4) code.
The provided code for the error program injects noise into an encoded file.
Entropy calculates the entropy of a file.


\section{Given}

\begin{itemize}
    \item{Header files for stack, path, and graph}
    \item{Pseudocode for recursive search}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Prelab Questions}

\begin{QandA}

\item Completed Lookup table

	\begin{answered}

        Table \vref{lookup} shows which error vector values are associated with
        which bits/ error codes.

        \begin{table}[ht]
            \centering
            \begin{tabular}{l|l}
                \textbf{Value} & \textbf{Bit} \\ \hline
                0              & 0            \\
                1              & 4            \\
                2              & 5            \\
                3              & HAM\_ERR     \\
                4              & 6            \\
                5              & HAM\_ERR     \\
                6              & HAM\_ERR     \\
                7              & 3            \\
                8              & 7            \\
                9              & HAM\_ERR     \\
                10             & HAM\_ERR     \\
                11             & 2            \\
                12             & HAM\_ERR     \\
                13             & 1            \\
                14             & 0            \\
                15             & HAM\_ERR    
            \end{tabular}
            \caption{Lookup Table}\label{lookup}
        \end{table}

    \end{answered}

\item Decode the following codes. If it contains an error, show and explain
    how to correct it.

    \begin{answered}
        1110 0011 $\rightarrow e$ = (1233) = (1011) = b1101 = 13 = 2nd bit

        1101 1000 $\rightarrow e$ = (2121) = (0101) = b1010 = 5 = HAM\_ERR
    \end{answered}

\end{QandA}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Programs}

\subsection{Encode}

This program encodes the Hamming(8,4) code. Bytes can be encoded from stdin or
a file, and to stdout or a file. The program arguments for encode are as follows:

\begin{itemize}
    \item{-h : Command line options}
    \item{-i infile : The file containing bytes to be encoded (default is stdin)}
    \item{-o outfile : The output file to store encoded bytes (default is stdout)}
\end{itemize}

\subsection{Decode}

This program decodes the Hamming(8,4) code. As in the encode program, Bytes
can be decoded from stdin or a file, and to stdout or a file. The program 
arguments for decode are as follows:

\begin{itemize}
    \item{-h : Command line options }
    \item{-v : Prints statists of the decoding process to stderr}
    \item{-i infile : The file containing bytes to be decoded (default is stdin)}
    \item{-o outfile : The output file to store decoded bytes (default is stdout)}
\end{itemize}

\subsection{Error}

The source code for this program is provided in the class resources repository.
Error adds noise to a file and is used to the efficacy of the encoding when decoded.

\begin{itemize}
    \item{-e : Percent of file to randomly add noise}
\end{itemize}

\subsection{Entropy}

The source code for this program is provided in the class resources repository.
Entropy calculates the entropy, or variation of contents, for a file.

\section{Parse}

Program arguments are parsed and stored using flags.
A set is not used since the order of the inputs is irrelevant and the parsed data
will ultimately be stored in variables anyway.

After program arguments are parsed the input file is parsed with encode or decode.
Execution happens with every grab of a byte to the buffer.
Refer to execute for how the algorithm works.

\section{Execute}

\subsection{Encode}

For encode, the parsed byte is divided into an upper and lower nibble. 
Then, the lower nibble is encoded and the byte is written to file out.
The same is done for the upper byte.
This process is repeated until the entire file is parsed. The pseudocode
is shown in \vref{encode}.

\begin{algorithm}
    initialize encode matrix G\;
    \While{buffer grabs byte from file\_in if not end of file} {
        lower = lower\_nibble(buffer)\;
        encoded lower = encode(encode matrix G, lower)\;
        write encoded lower to out file\;
        \vspace{0.4em}
        upper = upper\_nibble(buffer)\;
        encoded upper = encode(encode matrix, upper)\;
        write encoded upper to out file\;
    }

    delete encode matrix\;
    close files\;
    \caption{Encode}\label{encode}
\end{algorithm}

Encoding a nibble requires 3 main steps: converting a nibble to a bit
vector, multiplying by the encoding matrix, then converting the resulting
matrix back into a byte.

\subsection{Decode}

Decode is (unsurprisingly) the opposite of encode. After one byte is
parsed, it is decoded and stored in a variable last.
Every even odd iteration, a byte is parsed and decoded like before,
but instead of storing in last, the function pack\_byte is called
and puts the last nibble and current nibble together and writes to
stdout.
The pseduocode is shown in \vref{decode}.

\begin{algorithm}
    initialize decode matrix Ht\;
    initialize analytic variables\;
    \While{buffer grabs byte from file\_in if not end of file} {
        increment processed bytes\;
        initialize message pointer\;
        error = decode(decode matrix Ht, buffer, pointer to decoded message)\;
		error handling\;
        \vspace{0.4em}
        \eIf{processed bytes is even}{
            last = msg\;
            }{
            decoded = pack\_byte(msg, last)\;
            write decoded to out file\;
        }
    }

    delete encode matrix\;
    close files\;
    \caption{Decode}\label{decode}
\end{algorithm}

Decoding a byte is not a simple as encoding since the result of the decode
dot product is an error vector instead of the decoded bit. To decode, a simalr
method to 

\end{document}
